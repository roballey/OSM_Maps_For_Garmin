#! /bin/sh
#
# Split single PBF file into multiple files for processing via mkgmap
#

show_help() {
  echo "Split a single PBF file into multiple files for processing via mkgmap"
  echo "Options:"
  echo "  -h  : Show this help"
  echo "  -r <REGION> : Specify the region to be split, defaults to 'oceania_nz_ni'"
}

# Set the name of the region being generated
region="oceania_nz_ni"

# Parse command line options
while getopts hcs:t: opt; do
    case $opt in
        h)
            show_help
            exit 0
            ;;
        r)  region=$OPTARG
            ;;
        *)
            show_help
            exit 1
            ;;
    esac
done

# Setup path to working files generated by this script
osm_work_dir="work/osmsplitmaps/${region}"

# Create directory (including parent directories) if it doesnt exist
mkdir -p ${osm_work_dir}

rm -f ${osm_work_dir}/*
java -Xmx2000m -jar tools/splitter-*/splitter.jar input/${region}.pbf --output-dir=${osm_work_dir}
